(this["webpackJsonpcoin-base"]=this["webpackJsonpcoin-base"]||[]).push([[0],{18:function(e,t,n){},20:function(e,t,n){},22:function(e,t,n){"use strict";n.r(t);var r,s,c=n(1),a=n.n(c),i=n(10),o=n.n(i),u=(n(18),n(9)),d=n(3),l=n.n(d),b=n(6),f=n(4);n(20);!function(e){e.buy="buy",e.sell="sell"}(r||(r={})),function(e){e.snapshot="snapshot",e.l2update="l2update"}(s||(s={}));var v=function(){var e=Object(b.a)(l.a.mark((function e(){var t,n,r,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat("https://api.pro.coinbase.com","/products"),e.next=3,fetch(t);case 3:return n=e.sent,r=[],e.next=7,n.json();case 7:return r=e.sent,s=(s=r.filter((function(e){return"USD"===e.quote_currency}))).sort((function(e,t){return e.base_currency<t.base_currency?-1:e.base_currency>t.base_currency?1:0})),e.abrupt("return",s);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),h=n(13),p=n(11),O=n(12),j=n(8),k=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=t[0],c=t[1];n<e.length&&e[n][0]===s?0===c?e.splice(n,1):e.splice(n,1,t):0!==c&&e.splice(n,0,t),0!==r&&e.length>r&&e.splice(r,e.length-r)},m=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=0,s=e?e.length:r;r<s;){var c=r+s>>>1;!n&&+e[c][0]<+t||n&&+e[c][0]>+t?r=c+1:s=c}return r},y=function(e,t){for(var n=0;n<e.length;n++){if(!(t<e[n][0]))return;e.splice(n,1)}},g=function(e,t){for(var n=0;n<e.length;n++){if(!(t>e[n][0]))return;e.splice(n,1)}},_=function(e,t,n,r){var s,c=Object(j.a)(t);try{for(c.s();!(s=c.n()).done;){var a=s.value,i=Number(a[0]),o=Number(a[1]);k(e.asks,[i,o],m(e.asks,i,!1),r),0!==o&&e.bids[0]&&i<e.bids[0][0]&&y(e.bids,i)}}catch(v){c.e(v)}finally{c.f()}var u,d=Object(j.a)(n);try{for(d.s();!(u=d.n()).done;){var l=u.value,b=Number(l[0]),f=Number(l[1]);k(e.bids,[b,f],m(e.bids,b,!0),r),0!==f&&e.asks[0]&&b>e.asks[0][0]&&g(e.asks,b)}}catch(v){d.e(v)}finally{d.f()}return e},x=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;Object(p.a)(this,e),this._data=void 0,this.memoryLimit=void 0,this._data=new Map,this.memoryLimit=t}return Object(O.a)(e,[{key:"getSymbolList",value:function(){return Array.from(this._data.keys())}},{key:"hasOrderBook",value:function(e){return this._data.has(e)}},{key:"removeSymbolFromOrderBook",value:function(e){this.hasOrderBook(e)&&this._data.delete(e)}},{key:"getOrderBook",value:function(e){return this._data.get(e)}},{key:"updateOrderBook",value:function(e,t,n){var r=this.memoryLimit,s=this._data.get(e);s?this._data.set(e,_(Object(h.a)({},s),t,n,r)):this._data.set(e,_({asks:[],bids:[]},t,n,r))}}]),e}(),B=n(0),S=function(e){var t=new x(10),n=Object(c.useState)([]),a=Object(f.a)(n,2),i=a[0],o=a[1],d=Object(c.useState)(""),h=Object(f.a)(d,2),p=h[0],O=h[1],j=Object(c.useState)(),k=Object(f.a)(j,2),m=k[0],y=k[1],g=Object(c.useRef)(null),_=Object(c.useRef)(!1);Object(c.useEffect)((function(){return g.current=new WebSocket("wss://ws-feed.pro.coinbase.com"),function(){var e=Object(b.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v();case 2:t=e.sent,console.log(t),o(t),_.current=!0;case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()(),function(){g.current.close()}}),[]),Object(c.useEffect)((function(){if(_.current){var e={type:"subscribe",product_ids:[p],channels:["ticker","level2"]},t=JSON.stringify(e);g.current.send(t),g.current.onmessage=S}}),[p]);var S=function(e){var n=JSON.parse(e.data);if(n.type===s.snapshot)return t.updateOrderBook(p,n.asks,n.bids),void y(t.getOrderBook(p));var r=(null===m||void 0===m?void 0:m.asks)?Object(u.a)(null===m||void 0===m?void 0:m.asks):[],c=(null===m||void 0===m?void 0:m.bids)?Object(u.a)(null===m||void 0===m?void 0:m.bids):[];if(n.type===s.l2update&&n.product_id===p){var a=n.changes,i=w({changes:a,asks:r,bids:c}),o=Object(f.a)(i,2),d=o[0],l=o[1];t.updateOrderBook(p,d,l),y(t.getOrderBook(p))}},w=function(e){for(var t=e.changes,n=e.asks,s=e.bids,c=0,a=0;a<t.length;a++){c=0;var i=t[a],o=Object(f.a)(i,3),u=o[0],d=o[1],l=o[2];u===r.buy&&(c=+l,s.push([d,c])),u===r.sell&&(c=+l,n.push([d,c]))}return[n,s]};return Object(B.jsxs)("div",{className:"container",children:[Object(B.jsx)("select",{name:"instruments",value:p,onChange:function(e){var n={type:"unsubscribe",product_ids:[p],channels:["level2"]};g.current.send(JSON.stringify(n)),t.removeSymbolFromOrderBook(p),y(t.getOrderBook(p)),O(e.target.value)},children:i&&i.map((function(e,t){return Object(B.jsx)("option",{value:e.id,children:e.display_name},t)}))}),Object(B.jsxs)("div",{children:["Bid",Object(B.jsx)("ul",{children:m&&(null===m||void 0===m?void 0:m.bids.map((function(e,t){return Object(B.jsxs)("li",{children:["".concat(e[0]," -> ").concat(e[1])," "]})})))})]}),Object(B.jsxs)("div",{children:["Asks",Object(B.jsx)("ul",{children:m&&(null===m||void 0===m?void 0:m.asks.map((function(e,t){return Object(B.jsxs)("li",{children:["".concat(e[0]," -> ").concat(e[1])," "]})})))})]})]})},w=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,23)).then((function(t){var n=t.getCLS,r=t.getFID,s=t.getFCP,c=t.getLCP,a=t.getTTFB;n(e),r(e),s(e),c(e),a(e)}))};o.a.render(Object(B.jsx)(a.a.StrictMode,{children:Object(B.jsx)(S,{})}),document.getElementById("root")),w()}},[[22,1,2]]]);
//# sourceMappingURL=main.92bbdf23.chunk.js.map